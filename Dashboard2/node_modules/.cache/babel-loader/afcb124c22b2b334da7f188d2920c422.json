{"ast":null,"code":"import { createCommentVNode as _createCommentVNode, createElementVNode as _createElementVNode, vModelText as _vModelText, withDirectives as _withDirectives, withModifiers as _withModifiers, openBlock as _openBlock, createElementBlock as _createElementBlock, pushScopeId as _pushScopeId, popScopeId as _popScopeId } from \"vue\";\n\nconst _withScopeId = n => (_pushScopeId(\"data-v-1947abec\"), n = n(), _popScopeId(), n);\n\nconst _hoisted_1 = {\n  class: \"container backdrop\"\n};\nconst _hoisted_2 = {\n  class: \"createPostForm\"\n};\n\nconst _hoisted_3 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"i\", {\n  style: {\n    \"float\": \"right\",\n    \"font-size\": \"20px\"\n  },\n  class: \"bi bi-x-lg\"\n}, null, -1\n/* HOISTED */\n));\n\nconst _hoisted_4 = [_hoisted_3];\nconst _hoisted_5 = {\n  class: \"form-outline mb-4\"\n};\n\nconst _hoisted_6 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  class: \"form-label\",\n  for: \"title\"\n}, \"Title\", -1\n/* HOISTED */\n));\n\nconst _hoisted_7 = {\n  class: \"form-outline mb-4\"\n};\n\nconst _hoisted_8 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  class: \"form-label\"\n}, \"Content\", -1\n/* HOISTED */\n));\n\nconst _hoisted_9 = {\n  class: \"form-outline mb-4\"\n};\n\nconst _hoisted_10 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"label\", {\n  class: \"form-label\",\n  for: \"img_post\"\n}, \" Post Image\", -1\n/* HOISTED */\n));\n\nconst _hoisted_11 = /*#__PURE__*/_withScopeId(() => /*#__PURE__*/_createElementVNode(\"button\", {\n  type: \"submit\",\n  class: \"btn btn-primary btn-block mb-4\"\n}, \"Post\", -1\n/* HOISTED */\n));\n\nexport function render(_ctx, _cache, $props, $setup, $data, $options) {\n  return _openBlock(), _createElementBlock(\"div\", _hoisted_1, [_createCommentVNode(\"v-if='login' \"), _createElementVNode(\"div\", _hoisted_2, [_createElementVNode(\"button\", {\n    type: \"button\",\n    class: \"btn btn-outline-dark mb-1\",\n    \"data-mdb-ripple-color\": \"dark\",\n    onClick: _cache[0] || (_cache[0] = (...args) => $options.closeCreatePost && $options.closeCreatePost(...args))\n  }, _hoisted_4), _createElementVNode(\"form\", {\n    onSubmit: _cache[4] || (_cache[4] = _withModifiers((...args) => $options.post && $options.post(...args), [\"prevent\"]))\n  }, [_createCommentVNode(\" Name input \"), _createElementVNode(\"div\", _hoisted_5, [_withDirectives(_createElementVNode(\"input\", {\n    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = $event => _ctx.title = $event),\n    type: \"text\",\n    id: \"title\",\n    class: \"form-control border\"\n  }, null, 512\n  /* NEED_PATCH */\n  ), [[_vModelText, _ctx.title]]), _hoisted_6]), _createCommentVNode(\" Message input \"), _createElementVNode(\"div\", _hoisted_7, [_withDirectives(_createElementVNode(\"textarea\", {\n    \"onUpdate:modelValue\": _cache[2] || (_cache[2] = $event => _ctx.content = $event),\n    class: \"form-control border\",\n    id: \"content\",\n    rows: \"4\"\n  }, null, 512\n  /* NEED_PATCH */\n  ), [[_vModelText, _ctx.content]]), _hoisted_8]), _createCommentVNode(\" Image Upload \"), _createElementVNode(\"div\", _hoisted_9, [_hoisted_10, _createElementVNode(\"input\", {\n    type: \"file\",\n    onChange: _cache[3] || (_cache[3] = (...args) => _ctx.getImgPost && _ctx.getImgPost(...args)),\n    id: \"img_post\",\n    class: \"form-control border\"\n  }, null, 32\n  /* HYDRATE_EVENTS */\n  )]), _createCommentVNode(\" <input type=\\\"file\\\" class=\\\"form-control my-2\\\" id=\\\"img_post\\\" /> \"), _createCommentVNode(\" Submit button \"), _hoisted_11], 32\n  /* HYDRATE_EVENTS */\n  )])]);\n}","map":{"version":3,"mappings":";;;;;AACKA,OAAK,EAAC;;;AACNA,OAAK,EAAC;;;gEAEoGC,oBAAkE,GAAlE,EAAkE;AAA9DC,OAAsC,EAAtC;AAAA;AAAA;AAAA,GAA8D;AAAvBF,OAAK,EAAC;AAAiB,CAAlE;;AAAA;;oBAAAG;;AAIlGH,OAAK,EAAC;;;gEAETC,oBAAmD,OAAnD,EAAmD;AAA5CD,OAAK,EAAC,YAAsC;AAAzBI,KAAG,EAAC;AAAqB,CAAnD,EAAsC,OAAtC,EAA2C;AAAA;AAA3C;;;AAKGJ,OAAK,EAAC;;;gEAETC,oBAA0C,OAA1C,EAA0C;AAAnCD,OAAK,EAAC;AAA6B,CAA1C,EAA2B,SAA3B,EAAkC;AAAA;AAAlC;;;AAICA,OAAK,EAAC;;;iEACTC,oBAA4D,OAA5D,EAA4D;AAArDD,OAAK,EAAC,YAA+C;AAAlCI,KAAG,EAAC;AAA8B,CAA5D,EAAyC,aAAzC,EAAoD;AAAA;AAApD;;iEAOAH,oBAA0E,QAA1E,EAA0E;AAAlEI,MAAI,EAAC,QAA6D;AAApDL,OAAK,EAAC;AAA8C,CAA1E,EAA6D,MAA7D,EAAiE;AAAA;AAAjE;;;uBA5BRM,oBAgCQ,KAhCR,cAgCQ,CAhCwBC,oCAgCxB,EA/BRN,oBA8BU,KA9BV,cA8BU,CA5BVA,oBAA0L,QAA1L,EAA0L;AAAjLI,QAAI,EAAC,QAA4K;AAAnKL,SAAK,EAAC,2BAA6J;AAAjI,6BAAsB,MAA2G;AAAnGQ,WAAK,yCAAEC,6DAAF;AAA8F,GAA1L,aA4BU,EA1BFR,oBAyBD,MAzBC,EAyBD;AAzBYS,YAAM,wDAAUD,uCAAV,EAAc,WAAd;AAyBlB,GAzBC,GACAF,qCACAN,oBAGM,KAHN,cAGM,iBAFJA,oBAA6E,OAA7E,EAA6E;+DAA5DU,aAAKC,OAAuD;AAArDP,QAAI,EAAC,MAAgD;AAAzCQ,MAAE,EAAC,OAAsC;AAA9Bb,SAAK,EAAC;AAAwB,GAA7E;;AAAA,oBAAiBW,aAEb,EADJG,UACI,CAHN,GAMAP,wCACAN,oBAGM,KAHN,cAGM,iBAFJA,oBAAyF,UAAzF,EAAyF;+DAAtEU,eAAOC,OAA+D;AAA7DZ,SAAK,EAAC,qBAAuD;AAAjCa,MAAE,EAAC,SAA8B;AAApBE,QAAI,EAAC;AAAe,GAAzF;;AAAA,oBAAmBJ,eAEf,EADJK,UACI,CAHN,GAKFT,uCACAN,oBAGM,KAHN,cAGM,CAFJgB,WAEI,EADJhB,oBAAwF,OAAxF,EAAwF;AAAjFI,QAAI,EAAC,MAA4E;AAAhEa,YAAM,yCAAEP,2CAAF,CAA0D;AAA5CE,MAAE,EAAC,UAAyC;AAA9Bb,SAAK,EAAC;AAAwB,GAAxF;;AAAA,GACI,CAHN,GAIIO,8FAGFA,wCACAY,YAvBA;;AAAA,GA0BE,CA9BV,CA+BQ,CAhCR","names":["class","_createElementVNode","style","_hoisted_3","for","type","_createElementBlock","_createCommentVNode","onClick","$options","onSubmit","_ctx","$event","id","_hoisted_6","rows","_hoisted_8","_hoisted_10","onChange","_hoisted_11"],"sourceRoot":"","sources":["/home/fanny/Rendu2/C-COD-280-PAR-2-2-dashboard-vladimira.grosjean/Dashboard2/src/components/CreatePost.vue"],"sourcesContent":["<template>\r\n<div class=\"container backdrop\"><!--v-if='login' -->\r\n<div class=\"createPostForm\">\r\n  \r\n<button  type=\"button\" class=\"btn btn-outline-dark mb-1\" data-mdb-ripple-color=\"dark\" @click=\"closeCreatePost\"><i  style=\"float: right; font-size: 20px;\" class=\"bi bi-x-lg\"></i></button>\r\n    \r\n        <form v-on:submit.prevent=\"post\">\r\n        <!-- Name input -->\r\n        <div class=\"form-outline mb-4\">\r\n          <input  v-model=\"title\" type=\"text\" id=\"title\" class=\"form-control border\" />\r\n          <label class=\"form-label\" for=\"title\">Title</label>\r\n        </div>\r\n        \r\n          \r\n        <!-- Message input -->\r\n        <div class=\"form-outline mb-4\">\r\n          <textarea v-model=\"content\" class=\"form-control border\" id=\"content\" rows=\"4\"></textarea>\r\n          <label class=\"form-label\" >Content</label>\r\n        </div>\r\n     \r\n      <!-- Image Upload -->\r\n      <div class=\"form-outline mb-4\">\r\n        <label class=\"form-label\" for=\"img_post\"> Post Image</label>\r\n        <input type=\"file\" v-on:change=\"getImgPost\" id=\"img_post\" class=\"form-control border\" />\r\n      </div>\r\n          <!-- <input type=\"file\" class=\"form-control my-2\" id=\"img_post\" /> -->\r\n\r\n\r\n        <!-- Submit button -->\r\n        <button type=\"submit\" class=\"btn btn-primary btn-block mb-4\">Post</button> \r\n    \r\n</form>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nconst axios = require(\"axios\");\r\nexport default {\r\n  name: \"post\",\r\n  components: {},\r\n   props: ['idUser', 'user_id'],\r\n  data: () => {\r\n    return {\r\n      title: \"\",\r\n      user_id: \"\",\r\n      category_id: \"\",\r\n      content: \"\",\r\n      img_post: \"\",\r\n      categorie: \"\",\r\n          };\r\n  },\r\n  methods: {\r\n    closeCreatePost(){\r\n      this.$emit('close')\r\n    },\r\n    async post(event) {     \r\n      event.preventDefault();\r\n      console.log(this.user_id);\r\n      const preview = document.querySelector('img_post');\r\n        const file = document.querySelector('input[type=file]').files[0];\r\n        const reader = new FileReader();\r\n        let image = '';\r\n        await reader.addEventListener(\"load\", async () => {\r\n          // on convertit l'image en une chaîne de caractères base64\r\n          image = reader.result;\r\n          console.log(image);\r\n          fetch(image)\r\n          .then(res => res.blob())\r\n          .then(blob => {\r\n            console.log(blob)\r\n             axios.post(\"http://localhost:8000/api/posts\", {\r\n          title: this.title,\r\n          user_id: '',\r\n          category_id: this.categorie,\r\n          content: this.content,\r\n          img_post: image,\r\n            })          \r\n        })\r\n        .then((response) => {\r\n          console.log('table')\r\n          console.table([this.title,\r\n          this.user_id,\r\n          this.category_id,\r\n          this.content,\r\n          this.img_post])\r\n          console.log(response.data);\r\n          var result = response.data;\r\n          if (result != null) {\r\n            alert(\"Post bien créé!\");\r\n            \r\n          }\r\n        })\r\n        .catch((error) => {\r\n          console.log(error);\r\n        })\r\n        }, false);\r\n\r\n        if (file) {\r\n          await reader.readAsDataURL(file);\r\n          setTimeout(() => {\r\n\r\n          location.reload()\r\n\r\n          }, 2000);\r\n\r\n\r\n          \r\n    }\r\n        axios\r\n          .get(\"http://localhost:8000/api/posts\", {})\r\n          .then((response) => {\r\n            console.log(response.data);\r\n          })\r\n          .catch((error) => {\r\n            alert(error);\r\n            console.log(error);\r\n          });\r\n          \r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.createPostForm {\r\n  width: 50%;\r\n  padding: 20px;\r\n  margin: 100px auto;\r\n  background: white;\r\n}\r\n.backdrop {\r\n  top: 0;\r\n  position: fixed;\r\n  background: rgba(0, 0, 0, 0.5);\r\n  width: 100%;\r\n  height: 100%;\r\n\r\n}\r\n</style>"]},"metadata":{},"sourceType":"module"}